!function(){var t=$(".addAnswer"),n=$(".close"),a=$(".modal-btn"),e=$(".tab-questions__add"),o=$("#tableAnswers"),d=$("#tableQuestions"),i=$("#questionForm"),l=$(".modal-title"),r="/admin/",s=null,c=function(){d.empty();runAjax("/admin/question/",null).done(function(t){d.append("<tr><th>#</th><th>Вопрос</th><th>Ответы</th><th>Правильный ответ (№)</th><th>Act.</th></tr>"),$.each(t.row,function(t,n){var a="<tr><td>"+(t+1)+"</td><td>"+n.questions+"</td><td>";$.each(n.answers.split(";"),function(t,n){a+="<p>"+(t+1)+". "+n+"</p>"}),a+="</td><td>"+n.right+'</td><td><img src="img/edit.png" class="modal__edit" alt="edit" data-id="'+n.id+'" data-toggle="modal" data-target="#questionModal"><img src="img/trash.png" class="modal__delete" alt="recycle" data-id="'+n.id+'"></td></tr>',d.append(a)})}).fail(function(){d.append('<tr><td colspan="5">Вопросов пока нет..</td></tr>')})},u=function(){a.on("click",f),n.on("click",w),t.on("click",m),d.on("click",".modal__delete",g),d.on("click",".modal__edit",q),e.on("click",p)},f=function(t){t.preventDefault(),a.hasClass("modal-edit")&&b(),a.hasClass("modal-save")&&v()},p=function(){h(1),a.addClass("modal-save"),l.text("Добавление вопроса")},m=function(t){t.preventDefault(),h(s)},h=function(n){if(6===n)return t.prop("disabled",!0),!1;t.prop("disabled",!1);var a='<div class="form-group answer"><label>Ответ '+n+'<input type="text" name="answer'+n+'"\tclass="form-control" placeholder="Ответ на вопрос"></label></div>';$(".rowanswer").append(a),s=n+1},g=function(t){if(!confirm("Подтвердите удаление."))return!1;var n=$(t.target).attr("data-id");runAjax(r+"delete/"+n,null).done(function(){c()}).fail(function(){console.log("error")})},v=function(){var t=i.serialize();runAjax("/admin/add/",t).done(function(){c(),w(),$("#questionModal").modal("hide")}).fail(function(){console.log("error")})},w=function(){$("#questionForm").trigger("reset"),$(".answer").remove(),a.removeClass("modal-save modal-edit"),s=null,t.prop("disabled",!1)},q=function(t){a.addClass("modal-edit"),l.text("Редактирование вопроса");var n=$(".rowanswer"),e=$(".modal-question"),o=$(".modal-answerright"),d=$(t.target).attr("data-id");runAjax(r+"getOne/"+d,null).done(function(t){$(".modal-id").val(t.question[0].id),e.val(t.question[0].questions);var a=t.question[0].answers.split(";");$.each(a,function(t,a){var e='<div class="form-group answer"><label>Ответ '+(t+1)+'<input type="text" name="answer'+(t+1)+'"\tclass="form-control" placeholder="Ответ на вопрос" value="'+a+'"></label></div>';n.append(e),s=t+2}),o.val(t.question[0].right)}).fail(function(){console.log("error")})},b=function(){var t=i.serialize();runAjax("/admin/edit/",t).done(function(){c(),w(),$("#questionModal").modal("hide")}).fail(function(){console.log("error")})};(function(){runAjax("/admin/answer/",null).done(function(t){o.append('<tr><th>#</th><th class="table-FIO">ФИО</th><th>Правильных ответов</th></tr>'),$.each(t.row,function(t,n){var a='<tr class="table-'+(n.right>=80?"success":"danger")+'"><td>'+(t+1)+'</td><td class="text-capitalize">'+n.surname+" "+n.name+"</td><td>"+n.right+"%</td></tr>";o.append(a)})}).fail(function(){o.append('<tr><td colspan="3">Ответов пока нет..</td></tr>')})})(),c(),u()}();