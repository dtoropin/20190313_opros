!function(){var n=$(".container"),e=$("#questions"),a=$(".answer-block"),r=$(".answer-block__right"),i=$(".answerForm__btn"),s=$(".answerForm__item-input"),o=[],t=[],l=function(){$("#answerForm").on("submit",p),$(".answerForm__checkFIO").on("click",u)},u=function(e){e.preventDefault();var a=$("#inputname"),r=$("#inputsurname");if(a.on("keyup",d),r.on("keyup",d),""===a.val())return a.addClass("is-invalid"),!1;if(""===r.val())return r.addClass("is-invalid"),!1;var i="name="+a.val()+"&surname="+r.val();runAjax("/main/check/",i).done(function(e){if(!e.count)return n.html('<div class="alert alert-danger">Вы уже проходили опрос...</div>'),!1;$(".answerForm__checkFIO").hide(),$(".answerForm__question").show(),c()}).fail(function(){return n.html('<div class="alert alert-danger">Непредвиденный сбой сервера, попробуйте позже...</div>'),!1})},d=function(n){$(n.target).removeClass("is-invalid")},c=function(){runAjax("/main/get/",null).done(function(n){$.each(n.row,function(n,a){o.push(a.right);var r=a.questions,i=a.answers.split(";"),s='<div class="form-group jumbotron"><b>#'+(n+1)+'</b><p class="questions__question">'+r+"</p>";$.each(i,function(e,a){s+='<div class="radio"><label><input type="radio" class="questions__radio" name="question'+(n+1)+'" value="'+(e+1)+'">'+a+"</label></div>"}),s+="</div>\x3c!-- .form-group jumbotron --\x3e",e.append(s)}),i.prop("hidden",!1),$(".answerForm__head").prop("hidden",!1)}).fail(function(){e.append('<div class="form-group jumbotron">Вопросов пока не напечатали :(</div>'),i.prop("disabled",!0)})},p=function(e){e.preventDefault();var l=0;$.each(o,function(n,e){var a=$('.questions__radio[name="question'+(n+1)+'"]:checked');if($('.questions__radio[name="question'+(n+1)+'"][value='+e+"]").parent().css({color:"green",fontWeight:"bold"}),a.val()===e)l++;else{var r=a.parent().text(),i=a.parent().parent().siblings(".questions__question").text();t.push(i+"::"+r),a.parent().css({color:"red",fontWeight:"bold"})}}),$(".questions__radio").prop("disabled",!0);var u=(l/o.length*100).toFixed(2);$(".answerForm__right").val(u);var d=t.join(";");$(".answerForm__wrong-answers").val(d);var c=$(this).serialize();runAjax("/main/save/",c).done(function(){a.addClass(u>87?"bg-success":"bg-danger"),r.text(u+"%"),$("#successModal").modal("show"),i.prop("disabled",!0),s.prop("disabled",!0)}).fail(function(){return n.html('<div class="alert alert-danger">Непредвиденный сбой сервера, попробуйте позже...</div>'),!1})};l()}();