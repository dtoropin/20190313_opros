!function(){var n=$(".container"),e=$("#questions"),a=$(".answer-block"),r=$(".answer-block__right"),i=$(".answerForm__btn"),o=$(".answerForm__item-input"),s=[],t=function(){$("#answerForm").on("submit",c),$(".answerForm__checkFIO").on("click",l)},l=function(e){e.preventDefault();var a=$("#inputname"),r=$("#inputsurname");if(a.on("keyup",d),r.on("keyup",d),""===a.val())return a.addClass("is-invalid"),!1;if(""===r.val())return r.addClass("is-invalid"),!1;var i="name="+a.val()+"&surname="+r.val();runAjax("/main/check/",i).done(function(e){if(!e.count)return n.html('<div class="alert alert-danger">Вы уже проходили опрос...</div>'),!1;$(".answerForm__checkFIO").hide(),$(".answerForm__question").show(),u()}).fail(function(){return n.html('<div class="alert alert-danger">Непредвиденный сбой сервера, попробуйте позже...</div>'),!1})},d=function(n){$(n.target).removeClass("is-invalid")},u=function(){runAjax("/main/get/",null).done(function(n){$.each(n.row,function(n,a){s.push(a.right);var r=a.questions,i=a.answers.split(";"),o='<div class="form-group jumbotron"><b>#'+(n+1)+"</b><p>"+r+"?</p>";$.each(i,function(e,a){o+='<div class="radio"><label><input type="radio" class="questions__radio" name="question'+(n+1)+'" value="'+(e+1)+'">'+a+"</label></div>"}),o+="</div>\x3c!-- .form-group jumbotron --\x3e",e.append(o)}),i.prop("hidden",!1),$(".answerForm__head").prop("hidden",!1)}).fail(function(){e.append('<div class="form-group jumbotron">Вопросов пока не напечатали :(</div>'),i.prop("disabled",!0)})},c=function(e){e.preventDefault();var t=0;$.each(s,function(n,e){var a=$('.questions__radio[name="question'+(n+1)+'"]:checked');$('.questions__radio[name="question'+(n+1)+'"][value='+e+"]").parent().css({color:"green",fontWeight:"bold"}),a.val()===e?t++:a.parent().css({color:"red",fontWeight:"bold"})}),$(".questions__radio").prop("disabled",!0);var l=(t/s.length*100).toFixed(2);$(".answerForm__right").val(l);var d=$(this).serialize();runAjax("/main/save/",d).done(function(){a.addClass(l>80?"bg-success":"bg-danger"),r.text(l+"%"),$("#successModal").modal("show"),i.prop("disabled",!0),o.prop("disabled",!0)}).fail(function(){return n.html('<div class="alert alert-danger">Непредвиденный сбой сервера, попробуйте позже...</div>'),!1})};t()}();